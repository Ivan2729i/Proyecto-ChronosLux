{% extends 'base.html' %}

{% block content %}
<div class="container mx-auto px-4 py-12">
  <h1 class="font-serif font-black text-4xl md:text-4xl text-black mb-4 text-left">
        Crear Orden <span class="custom-text-secondary">de Suministro</span>
  </h1>

  {% if messages %}
    {% for message in messages %}
      {# Filtramos: Solo entra si el tag es 'error' #}
      {% if 'error' in message.tags %}
        <div class="p-4 mb-4 text-sm text-red-700 bg-red-100 rounded-lg border border-red-200" role="alert">
          <div class="flex items-center">
             <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg>
             <span class="font-medium">{{ message }}</span>
          </div>
        </div>
      {% endif %}
    {% endfor %}
  {% endif %}

  <form method="post" class="bg-white p-6 rounded-lg shadow-md border">
    {% csrf_token %}

    <div class="overflow-x-auto">
      <table class="min-w-full leading-normal">
        <thead>
          <tr class="border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
            <th class="px-5 py-3">Producto</th>
            <th class="px-5 py-3">Marca</th>
            <th class="px-5 py-3">Stock Actual</th>
            <th class="px-5 py-3">Cantidad a Suministrar</th>
            <th class="px-5 py-3">Costo Unitario (MXN)</th>
          </tr>
        </thead>
        <tbody>
          {% for producto in productos %}
          <tr class="border-b border-gray-200 hover:bg-gray-50">
            <td class="px-5 py-4 text-sm font-semibold">{{ producto.nombre }}</td>
            <td class="px-5 py-4 text-sm">{{ producto.marca.nombre }}</td>
            <td class="px-5 py-4 text-sm">{{ producto.stock }}</td>
            <td class="px-5 py-4">
              <input type="number" name="cantidad_{{ producto.id }}" min="0" value="0" class="w-24 px-2 py-1 border border-gray-300 rounded-md">
            </td>
            <td class="px-5 py-4">
              <input type="number" name="costo_{{ producto.id }}" min="0" step="0.01" value="0.00" class="w-32 px-2 py-1 border border-gray-300 rounded-md">
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="flex justify-end pt-6 gap-4">
      <a href="{% url 'portal_proveedor' %}"
         class="btn-animado bg-gray-200 text-gray-800 hover:bg-gray-300 hover:text-gray-900 font-semibold rounded-md">
        Cancelar
      </a>
      <button type="submit" class="btn-animado px-6 py-2 custom-bg-secondary custom-text-secondary-foreground font-semibold rounded-md">
        Enviar Orden
      </button>
    </div>
  </form>
</div>
{% endblock %}